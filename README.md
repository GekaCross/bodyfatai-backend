# BodyFatAI

Мобильное приложение для расчета процента жира в теле с использованием AI.

## Структура проекта

```
Body Fat/
├── backend/          # FastAPI бэкенд
│   ├── main.py      # Точка входа FastAPI
│   ├── models.py    # Pydantic модели
│   ├── config.py    # Конфигурация (чтение .env)
│   ├── services/    # Бизнес-логика
│   │   └── openai_client.py
│   ├── requirements.txt
│   └── docs/        # Примеры API запросов
│
└── mobile/          # React Native + Expo приложение
    ├── App.tsx
    ├── src/
    │   ├── screens/
    │   │   └── MainScreen.tsx
    │   ├── components/
    │   └── api/
    │       └── client.ts
    └── package.json
```

## Быстрый старт

### Бэкенд

1. Перейдите в папку `backend`:
```bash
cd backend
```

2. Создайте виртуальное окружение (рекомендуется):
```bash
python -m venv venv
source venv/bin/activate  # На Windows: venv\Scripts\activate
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

**Важно:** После обновления зависимостей (добавлены `python-multipart` и `pillow`), переустановите их:
```bash
pip install -r requirements.txt --upgrade
```

4. Создайте файл `.env` в папке `backend`:
```
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_MODEL=gpt-4o-mini
```

5. Запустите сервер:
```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

Сервер будет доступен по адресу: http://localhost:8000

API документация: http://localhost:8000/docs

### Мобильное приложение

1. Перейдите в папку `mobile`:
```bash
cd mobile
```

2. Установите зависимости:
```bash
npm install
```

3. Запустите приложение:
```bash
npm start
```

4. Откройте приложение на устройстве/эмуляторе:
   - Нажмите `i` для iOS симулятора
   - Нажмите `a` для Android эмулятора
   - Отсканируйте QR-код в приложении Expo Go на реальном устройстве

**Важно для подключения к бэкенду:**

- **iOS симулятор**: использует `localhost:8000` (уже настроено)
- **Android эмулятор**: использует `10.0.2.2:8000` (уже настроено)
- **Реальное устройство**: нужно изменить `API_BASE_URL` в `mobile/src/api/client.ts` на IP-адрес вашего компьютера в локальной сети

## Тестирование API

Примеры запросов находятся в файле `backend/docs/api_examples.http`.

Можно использовать curl:

```bash
curl -X POST "http://localhost:8000/api/bodyfat" \
  -H "Content-Type: application/json" \
  -d '{
    "gender": "male",
    "age": 30,
    "height": 180,
    "weight": 75,
    "waist": 85
  }'
```

## Особенности

- **Без API ключа**: бэкенд работает в режиме заглушки, используя простую формулу для демонстрации
- **С API ключом**: используется OpenAI API для более точных расчетов
- **Анализ фотографий**: при загрузке фото используется GPT-4 Vision для визуального анализа и более точного определения процента жира
- **Валидация**: все входные данные валидируются на бэкенде
- **Обработка ошибок**: понятные сообщения об ошибках на русском языке

## Анализ по фотографии

Приложение теперь поддерживает анализ фотографий для более точного определения процента жира:

1. **Загрузка фото**: пользователь может загрузить фотографию (опционально)
2. **Визуальный анализ**: GPT-4 Vision анализирует фото на предмет видимых признаков жира, мышечной массы и телосложения
3. **Комбинированный расчет**: результаты визуального анализа комбинируются с введенными параметрами (рост, вес, возраст, пол, обхват талии)

**Рекомендации по фото:**
- Фото в полный рост или торса
- Хорошее освещение
- Одежда, которая позволяет видеть контуры тела
- Фото спереди или сбоку

## Следующие шаги

- [ ] Подключить реальный OpenAI API
- [ ] Улучшить дизайн приложения
- [ ] Добавить историю измерений
- [ ] Добавить графики и статистику


